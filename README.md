# 财务凭证处理自动化工具

## 项目描述
这是一个使用Python和AI技术实现的自动化项目，用于自动整理和匹配银行流水会计凭证与回单，极大提升了财务工作效率。

## 技术栈
- **编程语言**: Python（Jupyter Notbook）
- **核心库**: Pandas, PyMuPDF, pathlib
- **AI工具**: DeepSeek
- **功能**: PDF分割、合并、关键字提取；数据清洗；自动化匹配

## 项目背景
原公司每月银行流水5000+条，需要3名财务人员耗时3天完成凭证与回单的匹配整理工作，存在耗时长、易出错的问题。

1.  **会计凭证**：准确记录财务事项的凭证，以凭证号标记，每个凭证号的会计凭证可能记录多笔财务事项。
2.  **银行回单**：公司每条银行交易流水都有对应的银行回单，作为会计凭证的附件。
3.  **凭证整理**：每张记录了银行交易流水的会计凭证都有对应的回单作为附件，财务人员每月需将其分别打印出后，找到每张凭证对应的银行回单，作为附件粘贴在凭证后，进行归档。

**存在的问题**：
原公司属于连锁餐饮行业，每月5家银行的银行流水总共5000+条，对应银行回单5000+份，人工归类整理程序复杂，耗时长、易出错。

## 我的工作
1.  **流程梳理**：将人工整理逻辑转化为Python自动化逻辑。具体包括：
-- **回单拆分**：从银行下载的回单PDF中，每页PDF包括2/3张回单，它们可能记录在不同凭证号的凭证中。手工处理需将回单打印后进行裁剪，再根据交易银行、日期、账号、金额、摘要等匹配到正确的凭证中，手工粘贴在凭证后作为其附件。因此，程序第一步，需要利用python对回单PDF进行拆分，使一页PDF中只包含一张回单，方便之后为其匹配凭证。
-- **回单关键字提取**：回单与凭证通过交易账号、交易日期、交易金额等关键字进行匹配，会计凭证中的关键字可直接从记账软件中导出为excel表格，而每一张回单PDF需用python中的PyMuPDF库提取关键字，作为其唯一标记。
-- **凭证号匹配**：提取出回单的关键字后，便可将回单与凭证进行关键字匹配，为每一张回单匹配一个凭证号，方便之后将其与凭证PDF匹配。
-- **凭证号提取**：每一页会计凭证对应一个凭证号，因此同样需要提取其凭证号作为凭证PDF的标记。
-- **凭证与回单匹配交叉打印**：回单与凭证PDF均标记上凭证号之后，便可按照凭证号分组，将二者匹配合并为一个PDF，最后打印出来，即实现了凭证与回单的匹配交叉打印。

2.  **程序开发**：利用deepseek辅助编写Python自动化脚本。
3.  **落地优化**：将程序应用于实际工作，并持续调试优化。

## 项目成果
- **效率提升**：将凭证整理时间从 **3人3天** 缩短至 **1人0.5天**，效率提升 **90%+**。
- **准确性**：解决了人工匹配易出错的问题，准确率接近100%。
- **可复用性**：程序可每月重复使用，持续创造价值。

## 如何使用
1.  将银行回单、发票等原始数据放入 `1. input` 文件夹（为防止信息泄露，对所有文件中敏感信息均做了相应处理，不影响案例展示及程序运行）。
2.  运行主程序：`凭证&回单整理_自动化.ipynb`。
3.  结果将输出在 `3. output` 文件夹，其中运行过程中产生的文件输出在`2. process`文件夹，可自行查看。

## 项目截图
1.  会计凭证示意图
<img width="664" height="828" alt="image" src="https://github.com/user-attachments/assets/f8731b88-a68e-4b6b-b0dc-bc105c4311d4" />
2.  银行回单示意图
<img width="1041" height="690" alt="image" src="https://github.com/user-attachments/assets/9e737531-0579-488c-b85b-28f48533dca8" />
3.  python代码运行成功示意图
<img width="715" height="120" alt="image" src="https://github.com/user-attachments/assets/fdfdb40c-176b-4fb7-91eb-fb4ce8ea501c" />
4.  整理完成的凭证与回单
<img width="500" height="705" alt="image" src="https://github.com/user-attachments/assets/27695c37-81f7-42c6-9c23-a360de2302b6" />




